I was 2/3 through writing these two scripts and became disillusioned with how complicated the syntax got. I decided to 
nuke the project and start from scratch